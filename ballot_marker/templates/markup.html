{% extends 'base.html' %}

{% block head %}
<title>Mark Ballot</title>
{% endblock %}

{% block body %}
<div class="outer">
    <div class="form">
        <form method="POST" >
            
            <br>
            Top Left<input type="radio" name="corner" id="left" style="left:0px;">Bottom Right<input type="radio" name="corner" id="right"style="right:0px;"><br>
            <input type="text" name="contest-name"><br>
                X  (left): <input type="text" id="x-click-l" name="x-click-l" value=0>
                X (right): <input type="text" id="x-click-r" name="x-click-r" value=0>
            <br>
                Y (left): <input type="text" id="y-click-l" name="y-click-l" value=0>
                Y (right): <input type="text" id="y-click-r" name="y-click-r" value=0>
            <br>Page <input type="number" name="pageNumber" max="{{ paths|length }}" min="1" value="1"/>
            
            <input type="hidden" name="image-dir" value="{{ dir }}"/><br><input type="submit" value="Add Contest">
        </form>
    </div>
    <a href="/" style="position: absolute; right: 10px; top: 10px;">Home</a>
    <div>
        {% if paths|length < 1 %}
            <h2>No paths available</h2>
        {% else %}
            <div id="image-wrapper">
            {% for path in paths %}
                
                <div class="image-display" id="image-display">
                    {{ paths.index(path) + 1}}<img src="{{ path }}" class="{{ path }} "></img>
                </div>
            {% endfor %}
            </div>
        {% endif %}
    </div>
</div>

<script>
    document.querySelectorAll('.image-display').forEach(item => {
        item.addEventListener('mousedown', function (e) {
            if (document.getElementById("left").checked) {
                var rect = e.target.getBoundingClientRect();
                // console.log(e.target)
                // console.log(rect.height)
                // console.log(rect.width)
                // console.log(rect.width/2)
                document.getElementById('x-click-l').value = ((e.x - rect.left)/rect.width).toFixed(4); 
                // document.getElementById('x-click-l').value = e.x
                // document.getElementById('y-click-l').value = e.y
                document.getElementById('y-click-l').value = ((e.y - rect.top)/rect.height).toFixed(4);
            }
        });
    });
    document.querySelectorAll('.image-display').forEach(item => {
        item.addEventListener('mousedown', function (e) {
            if (document.getElementById("right").checked) {
                    var rect = e.target.getBoundingClientRect();
                    console.log(e.target)
                    document.getElementById('x-click-r').value = ((e.x - rect.left)/rect.width).toFixed(4);
                    // document.getElementById('x-click-r').value = e.x
                    // document.getElementById('y-click-r').value = e.y
                    document.getElementById('y-click-r').value = ((e.y - rect.top)/rect.height).toFixed(4);
                }
        });
    });
</script>

{% endblock %}